import java.io.*;
import java.net.ServerSocket;
import java.net.Socket;
import java.net.SocketAddress;


public class Server extends Thread{

	Socket sock;
	
	public Server(Socket sock){
		this.sock = sock;
	}
	
	public void run(){
		
		OutputStream os =null;
		FileInputStream fis =null;
		try {
			SocketAddress addr= sock.getRemoteSocketAddress();
			System.out.println(addr.toString());
			os =sock.getOutputStream();
			////////
			os.write("HTTP/1.1 200 OK\r\n\r\n".getBytes());
//			os.write("<h1>hello world..</h1>".getBytes());
			
			File file = new File("www/abc.txt");
			fis= new FileInputStream(file);
			int su= 1;
			while((su=fis.read())!=-1){
				os.write(su);
			}
			
			os.flush();
		} catch (IOException e) {
			e.printStackTrace();
		}finally{
			try {
				if(fis!=null)fis.close();
				if(os!=null)os.close();
			} catch (IOException e) {
				e.printStackTrace();
			}
		}
	}
	
	public static void main(String[] args) {
		int port =8080;
		ServerSocket serv=null;
		
		try {
			serv=new ServerSocket(port);
			while(true){
				Socket sock = serv.accept();
				Server thr=new Server(sock);
				thr.start();
			}
		} catch (IOException e) {
			e.printStackTrace();
		}finally{
			try {
				if(serv!=null)serv.close();
			} catch (IOException e) {
				e.printStackTrace();
			}
		}
	}

}
